<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
  <title>SHREE</title>
  <script src="utility.js" type="text/javascript"></script>

  <link type="text/css" rel="stylesheet" href="stylesheet.css"/>

  </head>
<body>

  <div id="score2" ><pre>SCORE                               <button onclick="reset1()"id="button">PLAY</button><pre><div id="score">0</div></div>

</div>
  <canvas id="game" width="1300" height="700"></canvas>

<script>
var start=false;
var BLOCK_W=32;
var BLOCK_H=32;
var w=124;
var h=92;
var x2=0;
var y2=0;
var spacestart=false;
var s=3;
var t=6;
var translate=1300;
var translate2=translate+1300;
var translate3=translate2+500;
var t2=7;
var t3=5;
var t4;
var x2=0;var y2=0;
var spacedone=true;
var translate4;
var manx=60;
var secret=1;
var check=false;
var score=0;
var lo=100;
var many=293;
var requestId;
var jumpcount=0;
var gover=false;
var xi=4;
var block=new Sprite("block2.png",1000,1000);
var wall=new Sprite("anotheronoff.PNG",32,32);
var water=new Sprite("water.png",32,32);
var man=new Sprite("still.png",62,60);
var manstill=new Sprite("still.png",62,60);
var manrun=new Sprite("run.png",72,60);
var go=new Sprite("go.jpg",2000,1000);
var start=new Sprite("start.jpg",1101,726);
var special=new sprite("special.png",57,60);
var special2=new sprite("special2.png",60,60);
$(document).ready(function(){
mySound = new sound("l.mp3");
mysound=new sound("m.mp3");
  Context=new HTML("game",2000,1000);
InitializeKeyboard();
  DisableScrollbars();
});


$(document).mousemove(function(event){
    if (document.activeElement != document.body) document.activeElement.blur();
 });

$(window).load(function(){
start.draw(0,0,1101,726);
Context.context.rect(1101,0,726,1000);
Context.context.fillStyle="black";
Context.context.fill();
});

function sound(src) {
    this.sound = document.createElement("audio");
    this.sound.src = src;
    this.sound.setAttribute("preload", "auto");
    this.sound.setAttribute("controls", "none");
    this.sound.style.display = "none";
    document.body.appendChild(this.sound);
    this.play = function(){
        this.sound.play();
    }
    this.stop = function(){
        this.sound.pause();
    }
}

function render(){

  ResetAnimationCounter();
  Context.context.clearRect(0,0,2000,1000);
  DrawMap();//background image construction with blocks


if(start)
{


  if(key.rightArrow&&manx<1000)
  {
  manx=manx+xi;
  }
  else
  if(key.leftArrow&&manx>0){
      manx=manx-xi;
  }

  secret=0;//to know that the game has started once atleast
  mysound.stop();
  mySound.play();
  document.getElementById("score").textContent = Math.floor(score+=0.05);
  if(spacestart)
  {
    spaceStart();
  }
  else
  {
    console.log(many);
    if(translate4<manx&&translate4>-100)
    special2.drawAnimated(manx,many,[0,1,2,3,4,5,6,7,8,9,10,11],72,75,6);
    else
    manrun.drawAnimated(manx,many,[0,1,2,3,4,5,6,7]);
  }
}
else if(secret)
{
  t=0;
  manstill.drawAnimated(manx,many-8,[0,1,2,3]);//the games has never started,man stays still
}
else
{
  gameover();
  spacedone=true;
  gover=true;
  window.cancelAnimationFrame(render);
   mySound.stop();
    mysound.play();
  document.getElementById("button").textContent="SPACEBAR TO PLAY AGAIN";
}
requestId=window.requestAnimationFrame(render);
}


function reset1() {

    if (requestId) {
       window.cancelAnimationFrame(requestId);
       requestId = undefined;
    }
    restart();

        if (!requestId) {
          document.getElementById("button").textContent="spacebar and <  >";
          start=false;

           render();
        }
}
function restart()//resetting all values
{
  BLOCK_W=32;
  BLOCK_H=32;
  w=124;
  h=92;
  x2=0;
  y2=0;
  spacestart=false;
  s=3;
  t=6;
  oldscore=50;
  lo=100;
  translate=1300;
  translate2=translate+1300;
  translate3=translate2+500;
  t2=7;
  t3=5;
  t4;
  x2=0;var y2=0;
  spacedone=true;
  manx=60;
  secret=1;
  check=false;
  score=0;
  many=293;
  requestId;
  jumpcount=0;
  gover=false;
  xi=4;
}



</script>
</body>

</html>
